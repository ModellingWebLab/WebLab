# -*- coding: utf-8 -*-
# Generated by Django 1.11.20 on 2020-03-16 17:02
from __future__ import unicode_literals

from django.db import migrations



def runnable_to_exp_version(apps, schema_editor):
    ExperimentVersion = apps.get_model('experiments', 'ExperimentVersion')
    Runnable = apps.get_model('experiments', 'Runnable')
    for runnable in Runnable.objects.all():
        experiment_version = ExperimentVersion(runnable_ptr=runnable,
                                               experiment_key_id=runnable.experiment_id)
        experiment_version.save_base(raw=True)


def exp_version_to_runnable(apps, schema_editor):
    ExperimentVersion = apps.get_model('experiments', 'ExperimentVersion')
    Runnable = apps.get_model('experiments', 'Runnable')
    for experiment_version in ExperimentVersion.objects.all():
        runnable = experiment_version.runnable_ptr
        runnable.experiment_id = experiment_version.experiment_key_id
        runnable.save()


class Migration(migrations.Migration):

    dependencies = [
        ('experiments', '0026_experimentversion'),
    ]

    operations = [
        migrations.RunPython(runnable_to_exp_version, exp_version_to_runnable),
    ]
